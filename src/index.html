<!doctype html>
<html class="no-js" lang="">
  <head>
    <meta charset="utf-8">
    <title>CSP Builder</title>
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <style>
      body {
        font-family: Arial, sans-serif;
        font-size: 16px;
      }
      button, input, optgroup, select, textarea, label {
        margin: 0;
        font-family: inherit;
        font-size: inherit;
        line-height: inherit;
      }
      .resultText {
        -webkit-box-sizing: border-box;
        -moz-box-sizing: border-box;
        box-sizing: border-box;
        width: 100%;
        height: 240px;
        overflow-x: hidden;
        overflow-y: auto;
        border: 2px solid #038903;
        border-radius: 6px;
        padding: 6px;
        margin-bottom: 12px;
        line-height: 1.5;
      }
      .buttons {
        margin: 0.5rem auto 1rem;
        display: flex;
        flex-wrap: wrap;
        column-gap: 12px;
      }
      .btn {
        cursor: pointer;
        display: inline-block;
        font-weight: 400;
        text-align: center;
        white-space: nowrap;
        vertical-align: middle;
        -webkit-user-select: none;
        -moz-user-select: none;
        -ms-user-select: none;
        user-select: none;
        border: 1px solid transparent;
        padding: 0.375rem 0.75rem;
        font-size: 1rem;
        line-height: 1.5;
        border-radius: 0.25rem;
        transition: color .15s ease-in-out,background-color .15s ease-in-out,border-color .15s ease-in-out,box-shadow .15s ease-in-out;
      }
      .btnCopy {
        color: #fff;
        background-color: #28a745;
        border-color: #28a745;
      }
      .btnCopy:hover {
        color: #fff;
        background-color: #218838;
        border-color: #1e7e34;
      }
      .btnReset {
        color: #fff;
        background-color: #dc3545;
        border-color: #dc3545;
      }
      .btnReset:hover {
        color: #fff;
        background-color: #c82333;
        border-color: #bd2130;
      }
      .row {
        display: block;
        line-height: 1.5rem;
        margin: 0.25rem 0;
      }
      .p {
        line-height: 1.5rem;
      }
      .label {
        display: inline-block;
        line-height: 1.5;
      }
      .tab {
        margin: 4px 0 4px 12px;
      }
      .tab2 {
        margin: 4px 0 4px 24px;
      }
      .checkbox {
        cursor: pointer;
        width: 1em;
        height: 1em;
        margin-top: 0.25em;
        margin-right: 0.25rem;
        vertical-align: top;
        background-color: #fff;
        background-repeat: no-repeat;
        background-position: center;
        background-size: contain;
        border: 1px solid rgba(0,0,0,.25);
        /*-webkit-appearance: none;*/
        -moz-appearance: none;
        appearance: none;
        -webkit-print-color-adjust: exact;
        color-adjust: exact;
        border-radius: 0.25em;
      }
      .checkbox:focus {
        border-color: #86b7fe;
        outline: 0;
        box-shadow: 0 0 0 0.25rem rgba(13,110,253,.25);
      }
      .checkbox:checked {
        background-color: #0d6efd;
        border-color: #0d6efd;
        background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 20 20'%3e%3cpath fill='none' stroke='%23fff' stroke-linecap='round' stroke-linejoin='round' stroke-width='3' d='M6 10l3 3l6-6'/%3e%3c/svg%3e");
      }
      .label {
        cursor: pointer;
      }
    </style>
  </head>
  <body>

  <div
    id="result"
    class="resultText"
  ></div>

  <div class="buttons">
    <button
      id="btnCopy"
      class="btn btnCopy"
    >Copy</button>
    <button
      id="btnReset"
      class="btn btnReset"
    >Reset</button>
  </div>

  <fieldset>
    <legend>Enable your website's features:</legend>

    <div class="row">
      <input class="checkbox" type="checkbox" id="xfo" name="xfo">
      <label class="label" for="xfo">X-Frame-Options</label>
      <select id="s_xfo" name="xfo" disabled>
        <option value="DENY" selected>DENY</option>
        <option value="SAMEORIGIN">SAMEORIGIN</option>
      </select>
    </div>
    <p class="p tab">
      HTTP response header can be used to indicate whether or not a browser should be allowed to render a page in a &lt;frame&gt;, &lt;iframe&gt;, &lt;embed&gt; or &lt;object&gt;. Sites can use this to avoid clickjacking attacks, by ensuring that their content is not embedded into other sites.
    </p>
    <p class="p tab">
      Content Security Policy (CSP) frame-ancestors directive obsoletes X-Frame-Options for supporting browsers.
    </p>
    <p class="p tab">
      X-Frame-Options header is only useful when the HTTP response where it is included has something to interact with (e.g. links, buttons). If the HTTP response is a redirect or an API returning JSON data, X-Frame-Options does not provide any security.
    </p>

<!--    <div class="row tab">-->
<!--      <input class="checkbox" type="checkbox" id="gtmCustomVars" name="gtmCustomVars">-->
<!--      <label class="label" for="gtmCustomVars">Google Tag Custom Variables</label>-->
<!--    </div>-->

  </fieldset>

  <script async>
    /* DEFINITIONS */
    const HEADERS_TO_ADD = {
      xfo: {n: 'X-Frame-Options', v: 'DENY'}, // https://cheatsheetseries.owasp.org/cheatsheets/HTTP_Headers_Cheat_Sheet.html#x-frame-options
      xcto: {n: 'X-Content-Type-Options', v: 'nosniff'}, // https://cheatsheetseries.owasp.org/cheatsheets/HTTP_Headers_Cheat_Sheet.html#x-content-type-options
      xpcdp: {n: 'X-Permitted-Cross-Domain-Policies', v : 'none'}, //
      rp: {n: 'Referrer-Policy', v: 'strict-origin-when-cross-origin'}, // https://cheatsheetseries.owasp.org/cheatsheets/HTTP_Headers_Cheat_Sheet.html#referrer-policy
      ct: {n: 'Content-Type', v: 'text/html; charset=UTF-8'}, // https://cheatsheetseries.owasp.org/cheatsheets/HTTP_Headers_Cheat_Sheet.html#content-type
      cc: {n: 'Cache-Control', v: 'no-store, max-age=0'},
      p: {n: 'Pragma', v: 'no-cache'}, // The Pragma header is only specified for backwards compatibility with the HTTP/1.0 caches.
      // sc: {n: 'Set-Cookie', v: ''}, // https://cheatsheetseries.owasp.org/cheatsheets/HTTP_Headers_Cheat_Sheet.html#set-cookie
      sts: {n: 'Strict-Transport-Security', v: 'max-age=31536000 ; includeSubDomains'}, // https://cheatsheetseries.owasp.org/cheatsheets/HTTP_Headers_Cheat_Sheet.html#strict-transport-security-hsts
      acao: {n: 'Access-Control-Allow-Origin', v: 'https://yoursite.com'}, // https://cheatsheetseries.owasp.org/cheatsheets/HTTP_Headers_Cheat_Sheet.html#access-control-allow-origin
      coop: {n: 'Cross-Origin-Opener-Policy', v: 'same-origin'}, // https://cheatsheetseries.owasp.org/cheatsheets/HTTP_Headers_Cheat_Sheet.html#cross-origin-opener-policy-coop
      coep: {n: 'Cross-Origin-Embedder-Policy', v: 'require-corp'}, // https://cheatsheetseries.owasp.org/cheatsheets/HTTP_Headers_Cheat_Sheet.html#cross-origin-embedder-policy-coep
      corp: {n: 'Cross-Origin-Resource-Policy', v: 'same-origin'}, // https://cheatsheetseries.owasp.org/cheatsheets/HTTP_Headers_Cheat_Sheet.html#cross-origin-resource-policy-corp
      pp: {n: 'Permissions-Policy', v: 'accelerometer=(),ambient-light-sensor=(),autoplay=(),battery=(),camera=(),display-capture=(),document-domain=(),encrypted-media=(),fullscreen=(),gamepad=(),geolocation=(),gyroscope=(),layout-animations=(self),legacy-image-formats=(self),magnetometer=(),microphone=(),midi=(),oversized-images=(self),payment=(),picture-in-picture=(),publickey-credentials-get=(),speaker-selection=(),sync-xhr=(self),unoptimized-images=(self),unsized-media=(self),usb=(),screen-wake-lock=(),web-share=(),xr-spatial-tracking=()'}, // https://cheatsheetseries.owasp.org/cheatsheets/HTTP_Headers_Cheat_Sheet.html#permissions-policy-formerly-feature-policy
      // pp2: {n: 'Permissions-Policy', v: 'interest-cohort=()'}, // https://cheatsheetseries.owasp.org/cheatsheets/HTTP_Headers_Cheat_Sheet.html#floc-federated-learning-of-cohorts
      xdpc: {n: 'X-DNS-Prefetch-Control', v: 'off'}, // https://cheatsheetseries.owasp.org/cheatsheets/HTTP_Headers_Cheat_Sheet.html#x-dns-prefetch-control
      // xxp: {n: 'X-XSS-Protection', v: '0'}, // DEPRECATED: https://cheatsheetseries.owasp.org/cheatsheets/HTTP_Headers_Cheat_Sheet.html#x-xss-protection
      // pkp: {n: 'Public-Key-Pins', v: undefined}, // DEPRECATED: https://cheatsheetseries.owasp.org/cheatsheets/HTTP_Headers_Cheat_Sheet.html#public-key-pins-hpkp
      // fp: {n: 'Feature-Policy', v: undefined} // DEPRECATED
      // et: {n: 'Expect-CT', v: undefined} // DEPRECATED
      // csd: {n: 'Clear-Site-Data', v: '"cache","cookies","storage"'}
    };
    Object.fromEntries = arr => Object.assign({}, ...Array.from(arr, k => ({[k]: false})));
    const boxKeys = Object.keys(HEADERS_TO_ADD);
    const boxValues = Object.fromEntries(boxKeys);

    // Prevent information disclosure via HTTP headers
    const HEADERS_TO_REMOVE = [
      '$wsep',
      'Host-Header',
      'K-Proxy-Request',
      'Liferay-Portal',
      'Pega-Host',
      'Powered-By',
      'Product',
      'Server',
      'SourceMap',
      'X-AspNet-Version',
      'X-AspNetMvc-Version',
      'X-Atmosphere-error',
      'X-Atmosphere-first-request',
      'X-Atmosphere-tracking-id',
      'X-B3-ParentSpanId',
      'X-B3-Sampled',
      'X-B3-SpanId',
      'X-B3-TraceId',
      'X-CF-Powered-By',
      'X-CMS',
      'X-Content-Encoded-By',
      'X-Envoy-Attempt-Count',
      'X-Envoy-External-Address',
      'X-Envoy-Internal',
      'X-Envoy-Original-Dst-Host',
      'X-Envoy-Upstream-Service-Time',
      'X-Framework',
      'X-Generated-By',
      'X-Generator',
      'X-Mod-Pagespeed',
      'X-Old-Content-Length',
      'X-Page-Speed',
      'X-Php-Version',
      'X-Powered-By',
      'X-Powered-By-Plesk',
      'X-Powered-CMS',
      'X-Redirect-By',
      'X-Server-Powered-By',
      'X-SourceFiles',
      'X-SourceMap',
      'X-Turbo-Charged-By',
      'X-Varnish-Backend',
      'X-Varnish-Serve',
    ];

    // Prevent exposure to cross-site scripting when hosting uploaded files
    const ETC = {
      'Content-Disposition': 'attachment; filename="myfile.html"',
    }

    const MISC = {
      'Sec-Fetch-Dest': 'document',
      'Sec-Fetch-Mode': 'navigate',
      'Sec-Fetch-User': 'same-origin',
      'Sec-Fetch-Site': '?1'
    }

    function generateJSON() {
      // document.getElementById("result").innerHTML = '';
    }

    // Change events for feature toggling
    document.querySelectorAll('input[type="checkbox"]').forEach(cb => cb.addEventListener('change', function({target:{id, checked}}) {
      if (HEADERS_TO_ADD.hasOwnProperty(id)) {
        switch(id) {
          default:
            boxValues[id] = checked;
            const dropdown = document.getElementById(`s_${id}`);
            console.log(dropdown)

            if (dropdown) {
              dropdown.disabled = !checked;
            }

            generateJSON();
        }
      }
    }));

    // Change events for text inputs of custom IDs
    // Object.keys(customIDs).forEach(id => document.getElementById(id).addEventListener('input', (e) => {
    //   customIDs[id] = e.target.value || '*';
    //   generateJSON();
    // }));

    // Copy to clipboard
    // document.getElementById("btnCopy").onclick = () => {
    //   navigator.clipboard.writeText(cspStr);
    // }

    // Reset
    // document.getElementById("btnReset").onclick = () => {
    //   document.querySelectorAll('input[type="checkbox"]').forEach(cb => cb.checked = false);
    //   document.querySelectorAll('input[type="text"]').forEach(ti => ti.value = '');
    //   for (const [key] of Object.entries(customIDs)) {
    //     customIDs[key] = '*';
    //   }
    //   for (const [key] of Object.entries(boxValues)) {
    //     boxValues[key] = false;
    //   }
    //   generateJSON();
    // }
    //
    // generateJSON();
  </script>

  </body>
</html>